<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>유연근무 내역 변환기</title>
    <link rel="stylesheet" href="common.css">
    <link rel="stylesheet" href="flexible-work.css">
    <!-- SheetJS CDN -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-YY32QJSFKS"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-YY32QJSFKS');
    </script>
</head>
<body>
    <div class="container">
        <div class="header-with-link">
            <a href="index.html" class="back-link-btn">시간계산기</a>
            <h1>유연근무 내역 변환기</h1>
        </div>
        <p class="description">주별 유연근무 엑셀 파일을 업로드하여 특정 년/월의 데이터를 추출합니다.</p>

        <div class="upload-section">
            <div class="form-group">
                <label for="excelFiles">주별 유연근무 파일 선택 (여러 개 가능):</label>
                <div class="drop-zone" id="dropZone">
                    <input type="file" id="excelFiles" accept=".xlsx,.xls" multiple>
                    <div class="drop-zone-text">
                        <p>파일을 여기에 드래그하거나 클릭하여 선택</p>
                        <p class="drop-zone-hint">Excel 파일 (.xlsx, .xls)</p>
                    </div>
                </div>
                <p class="file-info">선택된 파일: <span id="fileCount">0</span>개 <span id="fileStatus"></span></p>
            </div>
        </div>

        <div class="calendar-section" id="calendarSection">
            <div class="calendar-header">
                <h2>데이터 범위</h2>
            </div>
            <div id="calendarContainer">
                <div class="empty-state">
                    <p>파일을 업로드하면 데이터 범위가 표시됩니다.</p>
                </div>
            </div>
        </div>

        <div class="preview-section" id="previewSection" style="display: none;">
            <h2>미리보기</h2>
            <div class="summary">
                <p>총 <span id="recordCount">0</span>개의 근무 기록이 발견되었습니다.</p>
            </div>
            <div class="table-container">
                <table id="previewTable">
                    <thead>
                        <tr>
                            <th>주간</th>
                            <th>주간총근무시간</th>
                            <th>날짜</th>
                            <th>근태구분</th>
                            <th>출근</th>
                            <th>퇴근</th>
                            <th>근무시간</th>
                            <th>주누적근무시간</th>
                        </tr>
                    </thead>
                    <tbody id="previewTableBody">
                    </tbody>
                </table>
            </div>
            <div class="action-buttons">
                <button type="button" onclick="downloadExcel()" id="downloadBtn">엑셀 파일로 다운로드</button>
                <button type="button" onclick="printTable()" id="printBtn">프린트하기</button>
            </div>
        </div>
    </div>

    <script src="flexible-work.js"></script>
</body>
</html>
